# Server Configuration
NODE_ENV=production
PORT=3000

# Database Configuration (Neon PostgreSQL)
# Get your connection string from Neon dashboard
# Format: postgres://user:password@host/database?sslmode=require
DATABASE_URL=postgresql://username:password@your-neon-host.neon.tech/certicredia?sslmode=require

# CORS Configuration
# In production, set this to your domain (e.g., https://www.certicredia.org)
CORS_ORIGIN=*

# Email Configuration (Resend)
# Render free tier blocks SMTP ports, so we use Resend API instead
# Get your API key from: https://resend.com/api-keys
# Free tier: 3,000 emails/month, 100 emails/day
RESEND_API_KEY=re_your_api_key_here

# Email Addresses
# From: Use 'onboarding@resend.dev' for testing, or your verified domain
EMAIL_FROM=onboarding@resend.dev
# To: Where contact form submissions and notifications are sent
NOTIFICATION_EMAIL=request@certicredia.org

# Security & Authentication
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Stripe Payment (optional - for card payments)
# STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
# STRIPE_PUBLIC_KEY=pk_test_your_stripe_public_key

# ==============================================================================
# CYBERSECURITY ACCREDITATION PLATFORM - ADDITIONAL CONFIGURATION
# ==============================================================================

# -------------------
# MFA/2FA Configuration
# -------------------
# TOTP secret base for generating user-specific MFA secrets
MFA_APP_NAME=CertiCredia
MFA_ISSUER=CertiCredia Italia
# Require MFA for specific roles (comma-separated: admin,specialist)
MFA_REQUIRED_ROLES=admin,specialist

# -------------------
# Password Policy
# -------------------
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
# Password expiry in days (0 = no expiry)
PASSWORD_EXPIRY_DAYS=90
# Number of previous passwords to check against
PASSWORD_HISTORY_COUNT=5

# -------------------
# Password Reset
# -------------------
# Token expiry in minutes
PASSWORD_RESET_TOKEN_EXPIRY=60
# URL base for reset links (used in emails)
PASSWORD_RESET_URL_BASE=https://www.certicredia.org/reset-password

# -------------------
# Email Verification
# -------------------
EMAIL_VERIFICATION_TOKEN_EXPIRY=1440
EMAIL_VERIFICATION_URL_BASE=https://www.certicredia.org/verify-email

# -------------------
# Storage Configuration (S3-compatible)
# -------------------
# Provider: 'aws' for AWS S3, 'cloudflare' for Cloudflare R2, 'local' for testing
STORAGE_PROVIDER=cloudflare
# S3/R2 Credentials
STORAGE_BUCKET=certicredia-evidence
STORAGE_REGION=auto
STORAGE_ENDPOINT=https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com
STORAGE_ACCESS_KEY=your_r2_access_key_id
STORAGE_SECRET_KEY=your_r2_secret_access_key
# Signed URL expiry in seconds (default: 3600 = 1 hour)
STORAGE_SIGNED_URL_EXPIRY=3600
# Max file size in MB
STORAGE_MAX_FILE_SIZE_MB=50
# Allowed file extensions (comma-separated)
STORAGE_ALLOWED_EXTENSIONS=pdf,doc,docx,xls,xlsx,png,jpg,jpeg,zip

# -------------------
# Assessment Configuration
# -------------------
# Current assessment framework version
ASSESSMENT_CURRENT_VERSION=1.0
# Allow draft auto-save interval in seconds
ASSESSMENT_AUTOSAVE_INTERVAL=30
# Days before assessment draft expires
ASSESSMENT_DRAFT_EXPIRY_DAYS=90

# -------------------
# Specialist Configuration
# -------------------
# Exam settings
SPECIALIST_EXAM_QUESTIONS_COUNT=50
SPECIALIST_EXAM_PASS_SCORE=80
SPECIALIST_EXAM_TIME_LIMIT_MINUTES=120
SPECIALIST_EXAM_MAX_ATTEMPTS=3
# CPE (Continuing Professional Education) requirements
SPECIALIST_CPE_ANNUAL_HOURS=40
SPECIALIST_CPE_CATEGORIES=training,audit,research,teaching
# Specialist assignment token expiry in hours
SPECIALIST_ASSIGNMENT_TOKEN_EXPIRY=72

# -------------------
# Accreditation Workflow
# -------------------
# Accreditation validity in months
ACCREDITATION_VALIDITY_MONTHS=12
# Pre-expiry notification days (comma-separated)
ACCREDITATION_NOTIFICATION_DAYS=30,15,7
# Auto-archive completed accreditations after months
ACCREDITATION_ARCHIVE_AFTER_MONTHS=24

# -------------------
# PDF Report Generation
# -------------------
# PDF generation service (internal or external API)
PDF_GENERATOR=internal
# Company info for certificates
PDF_COMPANY_NAME=CertiCredia Italia S.r.l.
PDF_COMPANY_ADDRESS=Via Example 123, 00100 Roma, Italia
PDF_COMPANY_VAT=IT12345678901
PDF_COMPANY_EMAIL=info@certicredia.org
PDF_COMPANY_WEBSITE=https://www.certicredia.org
# Digital signature for PDFs (optional)
PDF_SIGNATURE_ENABLED=false
# PDF_SIGNATURE_KEY_PATH=/path/to/private-key.pem
# PDF_SIGNATURE_CERT_PATH=/path/to/certificate.pem

# -------------------
# Audit Trail
# -------------------
# Enable comprehensive audit logging
AUDIT_ENABLED=true
# Audit log retention in days (0 = infinite)
AUDIT_RETENTION_DAYS=0
# Sensitive fields to mask in audit logs (comma-separated)
AUDIT_MASKED_FIELDS=password,password_hash,mfa_secret,credit_card

# -------------------
# Cron Jobs
# -------------------
# Enable automated background jobs
CRON_ENABLED=true
# CPE compliance check (runs annually on Jan 1st)
CRON_CPE_CHECK_SCHEDULE=0 0 1 1 *
# Accreditation expiry notifications (runs daily at 9 AM)
CRON_ACCREDITATION_NOTIFICATIONS_SCHEDULE=0 9 * * *
# Clean expired tokens (runs daily at 2 AM)
CRON_TOKEN_CLEANUP_SCHEDULE=0 2 * * *

# -------------------
# Rate Limiting
# -------------------
# API rate limit per IP (requests per window)
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MINUTES=15
# Auth endpoints stricter rate limit
RATE_LIMIT_AUTH_MAX_REQUESTS=10
RATE_LIMIT_AUTH_WINDOW_MINUTES=15

# -------------------
# Feature Flags
# -------------------
# Enable/disable specific features
FEATURE_SHOP_ENABLED=true
FEATURE_ACCREDITATION_ENABLED=true
FEATURE_SPECIALIST_EXAM_ENABLED=true
FEATURE_MULTI_LANGUAGE=false

# -------------------
# Admin Configuration
# -------------------
# Default super admin credentials (first run only)
ADMIN_DEFAULT_EMAIL=admin@certicredia.org
ADMIN_DEFAULT_PASSWORD=ChangeThisSecurePassword123!
# Admin panel path
ADMIN_PANEL_PATH=/admin

# -------------------
# Development/Debug
# -------------------
# Enable debug logging
DEBUG=false
# Log level: error, warn, info, debug
LOG_LEVEL=info
# Enable SQL query logging
SQL_LOGGING=false
